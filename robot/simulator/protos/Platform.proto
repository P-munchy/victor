#VRML_SIM V7.3.0 utf8

PROTO Platform [
  field SFString name "Platform000"
  field SFFloat length .240
  field SFFloat width  .240
  field SFFloat height .044
  field SFString type "1" # PlatformType
  field SFVec3f translation 0 0 0.022
  field SFRotation rotation 0 0 1 0
  field SFFloat density 250
  field SFColor platformColor .2 .2 .2
  field SFBool  useWhiteMarkerBackgrounds TRUE
  field SFString markerImg ""  # Image path relative to textures/
]
{
Solid {

  # Set markerURL
  %{
    markerURL = ""
    if fields.markerImg ~= "" then
      markerURL = "textures/" .. fields.markerImg
    end 
  }%

  name IS name
  model IS type
  translation IS translation
  rotation IS rotation
  contactMaterial "cmat_block"
  children [
        
    # Front Face
    VisionMarker {
      rotation 0 0 1 1.5708
      translation %{=fields.length/2}% 0 0
      image "symbols/platformNorth.png"
    }
    
    # Back Face
    VisionMarker { 
      rotation 0 0 1 -1.5708
      translation %{=-fields.length/2}% 0 0
      image "symbols/platformSouth.png"
    }
          
    # Right Face
    VisionMarker {
      rotation 0 0 1 3.1415
      translation 0 %{=fields.width/2}% 0
      image "symbols/platformEast.png"
    }
    
    # Left Face
    VisionMarker {
      rotation 0 0 1 0
      translation 0 %{=-fields.width/2}% 0
      image "symbols/platformWest.png"
    }
    
    # Top Face(s)
		VisionMarker {
			rotation 1 0 0 1.5708
			translation %{=-fields.length/4}% %{=-fields.width/4}% %{=fields.height/2}% 
			image "letters/inverted/A.png"
		}
		VisionMarker {
			rotation 1 0 0 1.5708
			translation %{=-fields.length/4}% %{=fields.width/4}% %{=fields.height/2}% 
			image "letters/inverted/B.png"
		}
		VisionMarker {
			rotation 1 0 0 1.5708
			translation %{=fields.length/4}% %{=-fields.width/4}% %{=fields.height/2}% 
			image "letters/inverted/C.png"
		}
		VisionMarker {
			rotation 1 0 0 1.5708
			translation %{=fields.length/4}% %{=fields.width/4}% %{=fields.height/2}% 
			image "letters/inverted/D.png"
		}

    DEF PlatformShape Group {
      children [
        Shape {
          appearance Appearance {
            material Material {
              diffuseColor IS platformColor
            }
          }
          geometry Box {
            size %{=fields.length}% %{=fields.width}% %{=fields.height}%
          }
        }
      ] # PlatformShape Children
    } # PlatformShape Group
    

  ] # Block Children
  
  boundingObject USE PlatformShape
  
  physics Physics {
    density IS density
  }
} # Solid (the actual platform)

  
} # PROTO


