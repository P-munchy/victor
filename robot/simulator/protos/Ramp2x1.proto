#VRML_SIM V7.3.0 utf8

PROTO Ramp2x1 [
  field SFString name "Ramp000"
  field SFFloat width .06
  field SFString type "1" # RampType
  field SFVec3f translation 0 0 0.022
  field SFRotation rotation 0 0 1 0
  field SFFloat density 250
  field SFColor blockColor .2 .2 .2
  field SFBool  useWhiteMarkerBackgrounds TRUE
  field SFString markerImg ""  # Image path relative to textures/

  # Observation
  #field SFColor obsColor 1 1 0
  #field SFFloat obsTransparency 1.0 # initially invisible
  #field SFVec3f obsTranslation 0 0 0
  #field SFRotation obsRotation 0  0 1 0 
]
{
Robot {

  # Set markerURL
  %{
    markerURL = ""
    if fields.markerImg ~= "" then
      markerURL = "textures/" .. fields.markerImg
    end 
  }%

  name IS name
  model IS type
  translation IS translation
  rotation IS rotation
  contactMaterial "cmat_ramp"
  
  children [
    DEF Block1x1Texture Transform {
      children [
        
        # Front Face
        VisionMarker {
          rotation -0.4653 -0.4653 0.7530 1.8508
          translation 0.0661 0 0
          image "symbols/rampFront.png"
          isDockable FALSE
        }
        
        # Back Face
        VisionMarker { 
          rotation 0 0 1 -1.5708
          translation -0.022 0 0
          image "symbols/rampBack.png"
          isDockable FALSE
        }
              
        # Right Face
        VisionMarker {
          rotation 0 0 1 3.1415
          translation 0.01 %{=fields.width/2}% 0
          image "symbols/rampRight.png"
          connectorName "rightConnector"
          connectorRotation 1 0 0 -1.57079
        }
        
        # Left Face
        VisionMarker {
          rotation 0 0 1 0
          translation 0.01 %{=-fields.width/2}% 0
          image "symbols/rampLeft.png"
          connectorName "leftConnector"
          connectorRotation 1 0 0 1.57079
        }

      ]
    }
    DEF RampShape Group {
      children [
        Shape {
          appearance Appearance {
            material Material {
              diffuseColor IS blockColor
            }
          }
          geometry Box {
            size 0.044 %{=fields.width}% 0.044
          }
        }
        Shape {
          appearance Appearance {
            material Material {
              diffuseColor IS blockColor
            }
          }
          geometry IndexedFaceSet {
            coord Coordinate {
              point [
                0.022 %{=-fields.width/2}% -.022
                0.110 %{=-fields.width/2}% -.022
                0.110 %{= fields.width/2}% -.022
                0.022 %{= fields.width/2}% -.022
                0.022 %{=-fields.width/2}%  .022
                0.022 %{= fields.width/2}%  .022
              ]
            }
            coordIndex [
              0, 1, 4, -1, 
              3, 5, 2, -1, 
              1, 2, 5, 4, -1, 
              3, 2, 1, 0
            ]
          }
        }
      ] # RampShape Children
    } # RampShape Group
    

  ] # Block Children
  
  boundingObject USE RampShape
  
  physics Physics {
    density IS density
  }
} # "Robot" (the actual ramp)

  
} # PROTO





# 
# #A 2x1 ramp prototype
# PROTO Ramp2x1 [
#   field SFVec3f translation 0 0.03 0
#   field SFRotation rotation 0 1 0 0
# ]
# {
# Robot {
#   translation IS translation
#   rotation IS rotation
#   children [
#     DEF Center Solid {
#       translation 0 -0.005 0.025
#       children [
#         Shape {
#           appearance Appearance {
#             texture ImageTexture {
#               url [
#                 "textures/coderampa.png"
#               ]
#             }
#           }
#           geometry DEF RAMP_BOX1 Box {
#             size 0.0603 0.03 0.03
#           }
#         }
#       ]
#       boundingObject USE RAMP_BOX1
#       physics Physics {
#         centerOfMass [
#           0 0 0
#         ]
#       }
#     }
#     DEF RAMP_BACK Solid {
#       translation 0 0.001 0.0015
#       children [
#         Shape {
#           appearance Appearance {
#             material DEF MAT_RAMP Material {
#               diffuseColor 0 0.494026 1
#             }
#           }
#           geometry DEF B01 Box {
#             size 0.06 0.0595 0.003
#           }
#         }
#       ]
#       contactMaterial "cmat_ramp"
#       boundingObject USE B01
#       physics Physics {
#       }
#     }
#     DEF RAMP_BOTTOM Solid {
#       translation 0 -0.028 0.06
#       children [
#         Shape {
#           appearance Appearance {
#             material DEF MAT_RAMP Material {
#               diffuseColor 0 0.494026 1
#             }
#           }
#           geometry DEF B01 Box {
#             size 0.06 0.003 0.12
#           }
#         }
#       ]
#       contactMaterial "cmat_ramp"
#       boundingObject USE B01
#       physics Physics {
#         density 5000
#       }
#     }
#     DEF RAMP_TOP Solid {
#       translation 0 0.0016 0.06
#       rotation 1 0 0 -1.12
#       children [
#         Shape {
#           appearance Appearance {
#             material USE MAT_RAMP
#           }
#           geometry DEF B01 Box {
#             size 0.06 0.132 0.003
#           }
#         }
#       ]
#       contactMaterial "cmat_ramp"
#       boundingObject USE B01
#       physics Physics {
#       }
#     }
#     DEF RAMP_SIDEL Solid {
#       translation -0.0301 -0.028 0.001
#       children [
#         Shape {
#           appearance Appearance {
#             material USE MAT_RAMP
#           }
#           geometry IndexedFaceSet {
#             coord Coordinate {
#               point [
#                 0 0 0
#                 0 0 0.12
#                 0 0.06 0
#               ]
#             }
#             coordIndex [
#               0, 1, 2
#             ]
#           }
#         }
#       ]
#       physics Physics {
#       }
#     }
#     DEF RAMP_SIDER Solid {
#       translation 0.0301 -0.028 0.0025
#       children [
#         Shape {
#           appearance Appearance {
#             material USE MAT_RAMP
#           }
#           geometry IndexedFaceSet {
#             coord Coordinate {
#               point [
#                 0 0 0
#                 0 0 0.12
#                 0 0.06 0
#               ]
#             }
#             ccw FALSE
#             coordIndex [
#               0, 1, 2
#             ]
#           }
#         }
#       ]
#       physics Physics {
#       }
#     }
#     Connector {
#       translation -0.0305 0.001 0.025
#       rotation 0 1 0 -1.5708
#       model "magnetic"
#       type "passive"
#       autoLock TRUE
#       distanceTolerance 0.002
#       snap FALSE
#     }
#     Connector {
#       translation 0.0305 0.001 0.025
#       rotation 0 1 0 1.5708
#       model "magnetic"
#       type "passive"
#       autoLock TRUE
#       distanceTolerance 0.002
#       snap FALSE
#     }
#   ]
#   name "solid"
#   physics Physics {
#     centerOfMass [
#       0 0 0
#     ]
#   }
# }
# 
# }