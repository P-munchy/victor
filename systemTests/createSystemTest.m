% function createSystemTest(outputFilename, inputFilenameRanges)

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00000_frontoParallel_100mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_52_34_frame0.png','cozmo_date2014_06_04_time16_52_43_frame0.png'}, 100, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00001_frontoParallel_100mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_52_57_frame0.png','cozmo_date2014_06_04_time16_53_06_frame0.png'}, 100, 0, 1)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00002_frontoParallel_150mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_53_19_frame0.png','cozmo_date2014_06_04_time16_53_28_frame0.png'}, 150, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00003_frontoParallel_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_53_53_frame0.png','cozmo_date2014_06_04_time16_54_02_frame0.png'}, 200, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00004_frontoParallel_250mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_54_26_frame0.png','cozmo_date2014_06_04_time16_54_36_frame0.png'}, 250, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00005_frontoParallel_250mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_54_49_frame0.png','cozmo_date2014_06_04_time16_54_58_frame0.png'}, 250, 0, 1)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00006_frontoParallel_300mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_04_time16_55_11_frame0.png','cozmo_date2014_06_04_time16_55_20_frame0.png'}, 300, 0, 0)

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00007_dice_frontoParallel_100mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_00_46_frame0.png','cozmo_date2014_06_10_time13_00_55_frame1.png'}, 100, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00008_dice_frontoParallel_100mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_01_09_frame0.png','cozmo_date2014_06_10_time13_01_18_frame0.png'}, 100, 0, 1)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00009_dice_frontoParallel_150mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_01_31_frame0.png','cozmo_date2014_06_10_time13_01_40_frame0.png'}, 150, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00010_dice_frontoParallel_150mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_01_53_frame0.png','cozmo_date2014_06_10_time13_02_03_frame0.png'}, 150, 0, 1)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00011_dice_frontoParallel_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_02_38_frame0.png','cozmo_date2014_06_10_time13_02_47_frame0.png'}, 200, 0, 0)
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00012_dice_frontoParallel_200mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_10_time13_03_01_frame0.png','cozmo_date2014_06_10_time13_03_10_frame1.png'}, 200, 0, 1)

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00013_sheet2_frontoParallel_50mm_lightOff.json',  'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_07_33_frame0.png','cozmo_date2014_06_16_time13_07_43_frame0.png'}, 50, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00014_sheet2_frontoParallel_50mm_lightOn.json',  'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_08_07_frame0.png','cozmo_date2014_06_16_time13_08_16_frame0.png'}, 50, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00015_sheet2_frontoParallel_100mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_08_29_frame0.png','cozmo_date2014_06_16_time13_08_38_frame0.png'}, 100, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00016_sheet2_frontoParallel_100mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_08_51_frame0.png','cozmo_date2014_06_16_time13_09_01_frame0.png'}, 100, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00017_sheet2_frontoParallel_150mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_09_14_frame0.png','cozmo_date2014_06_16_time13_09_22_frame0.png'}, 150, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00018_sheet2_frontoParallel_150mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_09_47_frame0.png','cozmo_date2014_06_16_time13_09_56_frame1.png'}, 150, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00019_sheet2_frontoParallel_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_10_20_frame0.png','cozmo_date2014_06_16_time13_10_30_frame0.png'}, 200, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00020_sheet2_frontoParallel_250mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_11_05_frame0.png','cozmo_date2014_06_16_time13_11_14_frame0.png'}, 250, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00021_sheet2_frontoParallel_250mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_11_27_frame0.png','cozmo_date2014_06_16_time13_11_36_frame0.png'}, 250, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00022_sheet2_frontoParallel_300mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_12_01_frame0.png','cozmo_date2014_06_16_time13_12_10_frame0.png'}, 300, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00023_sheet2_frontoParallel_300mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_12_23_frame0.png','cozmo_date2014_06_16_time13_12_32_frame0.png'}, 300, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00024_sheet2_frontoParallel_350mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_12_45_frame0.png','cozmo_date2014_06_16_time13_12_56_frame0.png'}, 350, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00025_sheet2_frontoParallel_350mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_13_08_frame0.png','cozmo_date2014_06_16_time13_13_16_frame0.png'}, 350, 0, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00026_sheet2_frontoParallel_400mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_13_41_frame0.png','cozmo_date2014_06_16_time13_13_50_frame0.png'}, 400, 0, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00027_sheet2_frontoParallel_400mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_14_03_frame0.png','cozmo_date2014_06_16_time13_14_12_frame0.png'}, 400, 0, 1);

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00028_sheet2_45degrees_100mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_36_51_frame0.png','cozmo_date2014_06_16_time13_37_00_frame0.png'}, 100, 45, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00029_sheet2_45degrees_100mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_37_13_frame0.png','cozmo_date2014_06_16_time13_37_22_frame0.png'}, 100, 45, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00030_sheet2_45degrees_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_38_08_frame0.png','cozmo_date2014_06_16_time13_38_17_frame0.png'}, 200, 45, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00031_sheet2_45degrees_200mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_38_31_frame0.png','cozmo_date2014_06_16_time13_38_40_frame0.png'}, 200, 45, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00032_sheet2_45degrees_300mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_39_37_frame0.png','cozmo_date2014_06_16_time13_39_46_frame0.png'}, 300, 45, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00033_sheet2_45degrees_300mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_40_00_frame0.png','cozmo_date2014_06_16_time13_40_09_frame0.png'}, 300, 45, 1);

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00034_sheet2_34degrees_100mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_41_51_frame0.png','cozmo_date2014_06_16_time13_42_00_frame0.png'}, 100, 34, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00035_sheet2_34degrees_100mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_42_13_frame0.png','cozmo_date2014_06_16_time13_42_22_frame0.png'}, 100, 34, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00036_sheet2_34degrees_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_42_57_frame0.png','cozmo_date2014_06_16_time13_43_06_frame0.png'}, 200, 34, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00037_sheet2_34degrees_200mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_43_31_frame0.png','cozmo_date2014_06_16_time13_43_40_frame0.png'}, 200, 34, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00038_sheet2_34degrees_300mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_44_28_frame0.png','cozmo_date2014_06_16_time13_44_36_frame0.png'}, 300, 34, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00039_sheet2_34degrees_300mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_45_05_frame0.png','cozmo_date2014_06_16_time13_45_16_frame0.png'}, 300, 34, 1);

% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00040_sheet2_72degrees_200mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_46_51_frame0.png','cozmo_date2014_06_16_time13_47_00_frame0.png'}, 200, 72, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00041_sheet2_72degrees_200mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_47_13_frame0.png','cozmo_date2014_06_16_time13_47_22_frame0.png'}, 200, 72, 1);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00042_sheet2_72degrees_300mm_lightOff.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_47_57_frame0.png','cozmo_date2014_06_16_time13_48_07_frame0.png'}, 300, 72, 0);
% createSystemTest('C:/Anki/products-cozmo/systemTests/tests/fiducialDetection_00043_sheet2_72degrees_300mm_lightOn.json', 'C:/Anki/systemTestImages', 'Z:/Documents/Box Documents/Cozmo SE/systemTestImages_all/', {'cozmo_date2014_06_16_time13_48_20_frame0.png','cozmo_date2014_06_16_time13_48_29_frame0.png'}, 300, 72, 1);

function createSystemTest(outputFilename, imageCopyPath, inputDirectory, inputFilenameRange, distance, angle, light)

numImagesRequired = 10; % for the .1:.1:1.0 exposures

fullFilename = strrep(mfilename('fullpath'), '\', '/');
slashIndexes = strfind(fullFilename, '/');
fullFilenamePath = fullFilename(1:(slashIndexes(end)));
templateFilename = [fullFilenamePath, 'testTemplate.json'];

jsonTestData = loadjson(templateFilename);
 
possibleInputFiles = dir([inputDirectory, '*.png']);

jsonTestData.Poses = [];

firstFile = inputFilenameRange{1};
lastFile = inputFilenameRange{2};

startIndex = -1;
for iIn = 1:length(possibleInputFiles)
    if strcmp(firstFile, possibleInputFiles(iIn).name)
        startIndex = iIn;
        break;
    end
end

endIndex = -1;
for iIn = startIndex:length(possibleInputFiles)
    if strcmp(lastFile, possibleInputFiles(iIn).name)
        endIndex = iIn;
        break;
    end
end

numImageFilesFound = (endIndex - startIndex + 1);
if numImageFilesFound ~= numImagesRequired
    disp(sprintf('%s has %d image files', outputFilename, numImageFilesFound));
    return;
end

exposure = 0.1;
for iIn = startIndex:endIndex
    curPose.ImageFile = ['../../../systemTestImages/', possibleInputFiles(iIn).name];
    curPose.Scene.CameraExposure = exposure;
    curPose.Scene.Distance = distance;
    curPose.Scene.angle = angle;    
    curPose.Scene.light = light;
    jsonTestData.Poses{end+1} = curPose;
    exposure = exposure + 0.1;
    
    copyfile([inputDirectory,possibleInputFiles(iIn).name], imageCopyPath);
end

disp(sprintf('Saving %s...', outputFilename));
savejson('', jsonTestData, outputFilename);

% keyboard
